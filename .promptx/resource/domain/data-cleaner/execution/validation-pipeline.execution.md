<execution>
  <constraint>
    ## æ•°æ®éªŒè¯é™åˆ¶æ¡ä»¶
    - **æ€§èƒ½çº¦æŸ**ï¼šéªŒè¯è¿‡ç¨‹ä¸å¾—æ˜¾è‘—å½±å“ç³»ç»Ÿæ€§èƒ½
    - **å®æ—¶æ€§çº¦æŸ**ï¼šå…³é”®æ•°æ®éªŒè¯å¿…é¡»åœ¨è§„å®šæ—¶é—´å†…å®Œæˆ
    - **èµ„æºçº¦æŸ**ï¼šéªŒè¯è¿‡ç¨‹çš„è®¡ç®—èµ„æºæ¶ˆè€—æœ‰é™
    - **å‡†ç¡®æ€§çº¦æŸ**ï¼šéªŒè¯ç»“æœå¿…é¡»å‡†ç¡®å¯é 
    - **å¯æ‰©å±•æ€§çº¦æŸ**ï¼šéªŒè¯æœºåˆ¶å¿…é¡»æ”¯æŒæ•°æ®é‡å¢é•¿
  </constraint>

  <rule>
    ## æ•°æ®éªŒè¯å¼ºåˆ¶è§„åˆ™
    - **å…¨è¦†ç›–éªŒè¯**ï¼šæ‰€æœ‰å…³é”®æ•°æ®å­—æ®µå¿…é¡»ç»è¿‡éªŒè¯
    - **å¤šå±‚éªŒè¯**ï¼šé‡‡ç”¨å¤šå±‚éªŒè¯æœºåˆ¶ç¡®ä¿æ•°æ®è´¨é‡
    - **å¼‚å¸¸é˜»æ–­**ï¼šä¸¥é‡è´¨é‡é—®é¢˜å¿…é¡»é˜»æ–­æ•°æ®æµ
    - **æ—¥å¿—è®°å½•**ï¼šæ‰€æœ‰éªŒè¯ç»“æœå¿…é¡»è¯¦ç»†è®°å½•
    - **å®šæœŸå¤éªŒ**ï¼šå®šæœŸå¯¹å†å²æ•°æ®è¿›è¡Œé‡æ–°éªŒè¯
  </rule>

  <guideline>
    ## æ•°æ®éªŒè¯æŒ‡å¯¼åŸåˆ™
    - **ä¸šåŠ¡ä¼˜å…ˆ**ï¼šéªŒè¯è§„åˆ™å¿…é¡»ç¬¦åˆä¸šåŠ¡é€»è¾‘
    - **åˆ†å±‚éªŒè¯**ï¼šä»åŸºç¡€åˆ°é«˜çº§çš„åˆ†å±‚éªŒè¯ç­–ç•¥
    - **è‡ªåŠ¨åŒ–ä¼˜å…ˆ**ï¼šä¼˜å…ˆä½¿ç”¨è‡ªåŠ¨åŒ–éªŒè¯æ–¹æ³•
    - **å¿«é€Ÿåé¦ˆ**ï¼šåŠæ—¶åé¦ˆéªŒè¯ç»“æœå’Œé—®é¢˜
    - **æŒç»­ä¼˜åŒ–**ï¼šåŸºäºéªŒè¯ç»“æœæŒç»­ä¼˜åŒ–è§„åˆ™
  </guideline>

  <process>
    ## ğŸ” æ•°æ®éªŒè¯æµæ°´çº¿

    ### éªŒè¯æ¶æ„è®¾è®¡
    ```mermaid
    graph TD
        A[æ•°æ®è¾“å…¥] --> B[é¢„éªŒè¯]
        B --> C[æ ¼å¼éªŒè¯]
        C --> D[ä¸šåŠ¡è§„åˆ™éªŒè¯]
        D --> E[å®Œæ•´æ€§éªŒè¯]
        E --> F[ä¸€è‡´æ€§éªŒè¯]
        F --> G[è´¨é‡è¯„åˆ†]
        G --> H{éªŒè¯é€šè¿‡?}
        H -->|æ˜¯| I[æ•°æ®è¾“å‡º]
        H -->|å¦| J[å¼‚å¸¸å¤„ç†]
        J --> K[ä¿®å¤å»ºè®®]
        K --> L[é‡æ–°éªŒè¯]
        L --> H
        
        style A fill:#e1f5fe
        style I fill:#e8f5e9
        style J fill:#ffebee
    ```

    ### ç¬¬ä¸€å±‚ï¼šæ ¼å¼éªŒè¯
    ```mermaid
    flowchart LR
        A[æ ¼å¼éªŒè¯] --> B[æ•°æ®ç±»å‹æ£€æŸ¥]
        A --> C[é•¿åº¦æ£€æŸ¥]
        A --> D[æ ¼å¼æ¨¡å¼æ£€æŸ¥]
        A --> E[ç¼–ç æ£€æŸ¥]
        
        B --> B1[æ•´æ•°éªŒè¯]
        B --> B2[æµ®ç‚¹æ•°éªŒè¯]
        B --> B3[æ—¥æœŸéªŒè¯]
        B --> B4[å­—ç¬¦ä¸²éªŒè¯]
        
        C --> C1[æœ€å°é•¿åº¦]
        C --> C2[æœ€å¤§é•¿åº¦]
        C --> C3[å›ºå®šé•¿åº¦]
        
        D --> D1[æ­£åˆ™è¡¨è¾¾å¼]
        D --> D2[æšä¸¾å€¼æ£€æŸ¥]
        D --> D3[æ ¼å¼æ¨¡æ¿]
        
        E --> E1[UTF-8æ£€æŸ¥]
        E --> E2[ç‰¹æ®Šå­—ç¬¦æ£€æŸ¥]
    ```

    ### ç¬¬äºŒå±‚ï¼šä¸šåŠ¡è§„åˆ™éªŒè¯
    ```mermaid
    graph TD
        A[ä¸šåŠ¡è§„åˆ™éªŒè¯] --> B[å•å­—æ®µè§„åˆ™]
        A --> C[å¤šå­—æ®µè§„åˆ™]
        A --> D[è·¨è¡¨è§„åˆ™]
        A --> E[æ—¶åºè§„åˆ™]
        
        B --> B1[å–å€¼èŒƒå›´]
        B --> B2[å¿…å¡«æ£€æŸ¥]
        B --> B3[å”¯ä¸€æ€§æ£€æŸ¥]
        
        C --> C1[å­—æ®µå…³è”æ€§]
        C --> C2[æ¡ä»¶ä¾èµ–]
        C --> C3[é€»è¾‘ä¸€è‡´æ€§]
        
        D --> D1[å¤–é”®çº¦æŸ]
        D --> D2[å‚ç…§å®Œæ•´æ€§]
        D --> D3[ä¸šåŠ¡å…³è”]
        
        E --> E1[æ—¶é—´é¡ºåº]
        E --> E2[çŠ¶æ€è½¬æ¢]
        E --> E3[ç”Ÿå‘½å‘¨æœŸ]
    ```

    ### ç¬¬ä¸‰å±‚ï¼šæ•°æ®è´¨é‡éªŒè¯
    ```mermaid
    flowchart TD
        A[æ•°æ®è´¨é‡éªŒè¯] --> B[å®Œæ•´æ€§éªŒè¯]
        A --> C[å‡†ç¡®æ€§éªŒè¯]
        A --> D[ä¸€è‡´æ€§éªŒè¯]
        A --> E[æ—¶æ•ˆæ€§éªŒè¯]
        
        B --> B1[ç¼ºå¤±å€¼æ£€æµ‹]
        B --> B2[ç©ºå€¼æ£€æµ‹]
        B --> B3[é»˜è®¤å€¼æ£€æµ‹]
        
        C --> C1[æ•°æ®ç²¾åº¦æ£€æŸ¥]
        C --> C2[è®¡ç®—ç»“æœéªŒè¯]
        C --> C3[ä¸šåŠ¡é€»è¾‘éªŒè¯]
        
        D --> D1[æ ¼å¼ä¸€è‡´æ€§]
        D --> D2[ç¼–ç ä¸€è‡´æ€§]
        D --> D3[æ ‡å‡†ä¸€è‡´æ€§]
        
        E --> E1[æ•°æ®æ–°é²œåº¦]
        E --> E2[æ›´æ–°é¢‘ç‡]
        E --> E3[æ—¶æ•ˆæ€§æ ‡è®°]
    ```

    ## ğŸ› ï¸ éªŒè¯å·¥å…·ä¸æŠ€æœ¯

    ### PythonéªŒè¯æ¡†æ¶
    ```python
    import pandas as pd
    from cerberus import Validator
    import great_expectations as ge
    
    # åŸºç¡€éªŒè¯è§„åˆ™å®šä¹‰
    validation_schema = {
        'user_id': {
            'type': 'integer',
            'required': True,
            'min': 1
        },
        'email': {
            'type': 'string',
            'required': True,
            'regex': r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$'
        },
        'age': {
            'type': 'integer',
            'min': 0,
            'max': 150
        },
        'created_at': {
            'type': 'datetime',
            'required': True
        }
    }
    
    # éªŒè¯æ‰§è¡Œ
    def validate_data(data, schema):
        validator = Validator(schema)
        results = []
        
        for record in data:
            if validator.validate(record):
                results.append({'status': 'valid', 'data': record})
            else:
                results.append({
                    'status': 'invalid', 
                    'data': record,
                    'errors': validator.errors
                })
        
        return results
    ```

    ### Great ExpectationséªŒè¯
    ```python
    # åˆ›å»ºæ•°æ®æœŸæœ›
    def create_data_expectations(df):
        # åŸºç¡€æœŸæœ›
        df.expect_table_row_count_to_be_between(min_value=1000, max_value=1000000)
        df.expect_column_to_exist('user_id')
        df.expect_column_values_to_not_be_null('user_id')
        df.expect_column_values_to_be_unique('user_id')
        
        # ä¸šåŠ¡æœŸæœ›
        df.expect_column_values_to_be_between('age', min_value=0, max_value=150)
        df.expect_column_values_to_match_regex('email', 
            r'^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$')
        
        # ç»Ÿè®¡æœŸæœ›
        df.expect_column_mean_to_be_between('age', min_value=20, max_value=60)
        df.expect_column_stdev_to_be_between('age', min_value=5, max_value=25)
        
        return df
    ```

    ### SQLéªŒè¯æŸ¥è¯¢
    ```sql
    -- å®Œæ•´æ€§éªŒè¯
    SELECT 
        COUNT(*) as total_records,
        COUNT(user_id) as non_null_user_id,
        COUNT(DISTINCT user_id) as unique_user_id,
        COUNT(email) as non_null_email
    FROM users;
    
    -- ä¸šåŠ¡è§„åˆ™éªŒè¯
    SELECT 
        COUNT(*) as invalid_age_records
    FROM users 
    WHERE age < 0 OR age > 150;
    
    -- æ ¼å¼éªŒè¯
    SELECT 
        COUNT(*) as invalid_email_records
    FROM users 
    WHERE email NOT REGEXP '^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$';
    ```

    ## ğŸ“Š éªŒè¯ç»“æœå¤„ç†

    ### éªŒè¯ç»“æœåˆ†ç±»
    ```mermaid
    graph TD
        A[éªŒè¯ç»“æœ] --> B{ä¸¥é‡ç¨‹åº¦}
        B -->|ä¸¥é‡| C[é˜»æ–­å¤„ç†]
        B -->|è­¦å‘Š| D[æ ‡è®°å¤„ç†]
        B -->|ä¿¡æ¯| E[è®°å½•å¤„ç†]
        
        C --> C1[åœæ­¢æ•°æ®æµ]
        C --> C2[å‘é€å‘Šè­¦]
        C --> C3[äººå·¥ä»‹å…¥]
        
        D --> D1[æ•°æ®æ ‡è®°]
        D --> D2[é™çº§å¤„ç†]
        D --> D3[ç›‘æ§è·Ÿè¸ª]
        
        E --> E1[æ—¥å¿—è®°å½•]
        E --> E2[ç»Ÿè®¡åˆ†æ]
        E --> E3[è¶‹åŠ¿ç›‘æ§]
    ```

    ### éªŒè¯æŠ¥å‘Šç”Ÿæˆ
    ```mermaid
    flowchart LR
        A[éªŒè¯å®Œæˆ] --> B[ç»“æœæ±‡æ€»]
        B --> C[æŠ¥å‘Šç”Ÿæˆ]
        C --> D[å¯è§†åŒ–å±•ç¤º]
        D --> E[åˆ†å‘é€šçŸ¥]
        
        B --> B1[é€šè¿‡ç‡ç»Ÿè®¡]
        B --> B2[é”™è¯¯åˆ†ç±»]
        B --> B3[è¶‹åŠ¿åˆ†æ]
        
        C --> C1[è¯¦ç»†æŠ¥å‘Š]
        C --> C2[æ‘˜è¦æŠ¥å‘Š]
        C --> C3[å¼‚å¸¸æŠ¥å‘Š]
        
        D --> D1[è´¨é‡ä»ªè¡¨æ¿]
        D --> D2[è¶‹åŠ¿å›¾è¡¨]
        D --> D3[å¼‚å¸¸çƒ­åŠ›å›¾]
    ```

    ## ğŸ”„ æŒç»­éªŒè¯æœºåˆ¶

    ### å®æ—¶éªŒè¯æµç¨‹
    ```mermaid
    graph LR
        A[æ•°æ®æµå…¥] --> B[å®æ—¶éªŒè¯]
        B --> C{éªŒè¯ç»“æœ}
        C -->|é€šè¿‡| D[æ­£å¸¸æµè½¬]
        C -->|å¤±è´¥| E[å¼‚å¸¸å¤„ç†]
        E --> F[å‘Šè­¦é€šçŸ¥]
        F --> G[äººå·¥å¤„ç†]
        G --> H[è§„åˆ™ä¼˜åŒ–]
        H --> B
        
        B --> B1[æµå¼éªŒè¯]
        B --> B2[æ‰¹é‡éªŒè¯]
        B --> B3[é‡‡æ ·éªŒè¯]
    ```

    ### éªŒè¯è§„åˆ™æ¼”è¿›
    ```mermaid
    flowchart TD
        A[éªŒè¯è§„åˆ™] --> B[æ•ˆæœè¯„ä¼°]
        B --> C[è§„åˆ™è°ƒæ•´]
        C --> D[æµ‹è¯•éªŒè¯]
        D --> E[è§„åˆ™å‘å¸ƒ]
        E --> F[ç›‘æ§åé¦ˆ]
        F --> B
        
        B --> B1[å‡†ç¡®ç‡è¯„ä¼°]
        B --> B2[è¦†ç›–ç‡è¯„ä¼°]
        B --> B3[æ€§èƒ½è¯„ä¼°]
        
        C --> C1[è§„åˆ™ä¼˜åŒ–]
        C --> C2[æ–°è§„åˆ™æ·»åŠ ]
        C --> C3[è¿‡æ—¶è§„åˆ™åˆ é™¤]
    ```
  </process>

  <criteria>
    ## æ•°æ®éªŒè¯è¯„ä»·æ ‡å‡†

    ### éªŒè¯å‡†ç¡®æ€§
    - âœ… éªŒè¯å‡†ç¡®ç‡ â‰¥ 99%
    - âœ… è¯¯æŠ¥ç‡ â‰¤ 1%
    - âœ… æ¼æŠ¥ç‡ â‰¤ 0.5%
    - âœ… è§„åˆ™è¦†ç›–ç‡ â‰¥ 95%

    ### éªŒè¯æ•ˆç‡
    - âœ… éªŒè¯æ—¶é—´ â‰¤ ä¸šåŠ¡è¦æ±‚
    - âœ… èµ„æºä½¿ç”¨ç‡åˆç†
    - âœ… å¹¶å‘å¤„ç†èƒ½åŠ›å¼º
    - âœ… æ‰©å±•æ€§è‰¯å¥½

    ### éªŒè¯å¯ç”¨æ€§
    - âœ… éªŒè¯è§„åˆ™æ˜“äºé…ç½®
    - âœ… éªŒè¯ç»“æœæ˜“äºç†è§£
    - âœ… å¼‚å¸¸å¤„ç†æœºåˆ¶å®Œå–„
    - âœ… ç›‘æ§å‘Šè­¦åŠæ—¶æœ‰æ•ˆ
  </criteria>
</execution>
